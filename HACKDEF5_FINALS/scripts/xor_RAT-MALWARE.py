#!/usr/bin/env python3
# DarkSide
# leax was here

import numpy as np
from binascii import unhexlify

def get_key(hint,encrypted):
    key = ""
    encoded = [encrypted[i:i+2] for i in range(0, len(encrypted), 2)]
    print(encoded)
    for letter in range(0,8):
        for i in range(1,200):
            if (ord(unhexlify(encoded[letter]))+letter^i)==ord(hint[letter]):
                print(chr(i),encoded[letter],hint[letter])
                key += chr(i)
    return key

def dexor(key):
    #Proceso de encriptado usando llave y mensaje secreto de ejemplo
    flag =""
    secret2 = "32510f58240b51010e5a41400f3f3c256a5c1c460ffc530f055d4459370f3d3905511a011c073c3b6f6b03013a133efc271d4a75ff215f476f005a017b56fd3c621c41037053091c1560240a7941fc3c" 
    secret = unhexlify(secret2)
    for i in range(10):
        x = 0 
        for j in range(i * 8, (i * 8) + 8):
            print(chr(secret[j]),key[x],i,j,x)
            al = np.uint8(ord(chr(secret[j]))+x)
            bl = np.uint8(ord(key[x])) 
            res_xor = np.uint8(bl ^ al)
            flag += chr(res_xor)
            x += 1
            pass  
        pass
    print(key,flag)
    #hackdef{Th1s_1s_0nly_the_m4lwar3_an4lys15_w4rmup}->HOST=52.43.208.168->PORT=1330
if __name__ == "__main__":
    dexor(get_key("hackdef{","32510f58240b5101"))
